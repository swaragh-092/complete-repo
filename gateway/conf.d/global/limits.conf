# ============================================================================
# Rate Limiting Configuration
# ============================================================================

# General API rate limiting (10 requests/sec)
limit_req_zone $binary_remote_addr zone=req_limit:10m rate=10r/s;

# Stricter rate limiting for sensitive endpoints (5 requests/min)
limit_req_zone $binary_remote_addr zone=login_limit:10m rate=5r/m;

# Static assets (relaxed - 50 requests/sec)
limit_req_zone $binary_remote_addr zone=static_limit:10m rate=50r/s;

# ============================================================================
# Connection Limiting
# ============================================================================

# Per-IP connection limit zone
limit_conn_zone $binary_remote_addr zone=conn_limit:10m;

# ============================================================================
# Request Body & Header Limits
# ============================================================================

# Maximum allowed request body size
client_max_body_size 10m;

# Timeout for reading client request body
client_body_timeout 12s;

# Timeout for reading client request headers
client_header_timeout 12s;

# Maximum size of request headers
large_client_header_buffers 4 16k;
